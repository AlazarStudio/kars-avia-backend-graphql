enum PassengerRequestStatus {
    CREATED
    ACCEPTED
    IN_PROGRESS
    COMPLETED
    CANCELLED
}

enum PassengerServiceStatus {
    NEW
    ACCEPTED
    IN_PROGRESS
    COMPLETED
    CANCELLED
}

type PassengerStatusTimes {
    acceptedAt   DateTime?
    inProgressAt DateTime?
    finishedAt   DateTime?
    cancelledAt  DateTime?
}

type PassengerServicePlan {
    enabled     Boolean   @default(false) // чекбокс в форме
    peopleCount Int?
    plannedAt   DateTime? // «Введите время»
}

type PassengerServicePerson {
    fullName String
    issuedAt DateTime? // время выдачи (14:30 в таблице)
    phone    String?
    seat     String? // если достанешь из скана
}

type PassengerWaterFoodService {
    plan   PassengerServicePlan? // включён ли сервис, сколько людей, во сколько
    status PassengerServiceStatus   @default(NEW)
    times  PassengerStatusTimes?
    people PassengerServicePerson[] // список ФИО + время выдачи
}

type PassengerServiceHotel {
    hotelId     String? @db.ObjectId // ссылка на Hotel, если выбран из базы
    name        String // снэпшот названия
    peopleCount Int // «Количество мест»
    address     String?
    link        String? // колонка «Ссылка» в таблице
}

type PassengerServiceDriver {
    fullName    String
    phone       String?
    peopleCount Int?
    pickupAt    DateTime? // время подачи / выезда
    link        String? // ссылка на маршрут, вотсап и т.д.
}

type PassengerLivingService {
    plan         PassengerServicePlan? // план по людям/времени заселения
    withTransfer Boolean                  @default(false) // чекбоксы: Проживание / Трансфер+Проживание
    status       PassengerServiceStatus   @default(NEW)
    times        PassengerStatusTimes?
    hotels       PassengerServiceHotel[] // таб «Проживание» и «Трансфер+проживание»
    drivers      PassengerServiceDriver[] // только если withTransfer = true
}

model PassengerRequest {
    id        String   @id @default(auto()) @map("_id") @db.ObjectId
    createdAt DateTime @default(now()) @map("created_at")
    updatedAt DateTime @updatedAt @map("updated_at")

    airline   Airline @relation(fields: [airlineId], references: [id], onDelete: NoAction)
    airlineId String  @db.ObjectId

    airport   Airport? @relation(fields: [airportId], references: [id])
    airportId String?  @db.ObjectId

    // данные рейса
    flightNumber String
    flightDate   DateTime? // если достаёшь из скана
    routeFrom    String?
    routeTo      String?

    plannedPassengersCount Int?

    // сервисы
    waterService  PassengerWaterFoodService?
    mealService   PassengerWaterFoodService?
    livingService PassengerLivingService?

    // общий статус заявки
    status      PassengerRequestStatus @default(CREATED)
    statusTimes PassengerStatusTimes?

    // кто создал (представитель)
    createdBy   User   @relation(fields: [createdById], references: [id])
    createdById String @db.ObjectId

    // общий чат по заявке (если понадобится)
    chats Chat[]
}
